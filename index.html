<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Kitty Becomes Rich</title>
    <link href="https://fonts.googleapis.com/css2?family=Lato:wght@400;700&display=swap" rel="stylesheet">
    <style>
        /* --- General Styling (Matches User Request) --- */
        html,body { height:100%; margin:0; }
        body {
            background: #000; /* Black Background */
            color: #fff; /* White Text */
            font-family: 'Lato', system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial;
            display:flex;
            align-items:center;
            justify-content:center;
            flex-direction:column;
            padding-top: 100px; /* Space for fixed header */
        }

        /* --- Header Display --- */
        #kittycoins {
            position: fixed;
            top: 10px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 60px;
            font-weight: 700;
            z-index: 1000;
            color: #ffffff;
            text-shadow: 0 2px 6px rgba(0,0,0,0.6);
        }

        .kps-display {
            position: fixed;
            top: 80px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 20px;
            font-weight: 400;
            color: #aaa;
            z-index: 1000;
        }

        /* --- Game Area --- */
        .game-area {
            text-align: center;
            /* margin-top: 120px; removed due to fixed header padding */
        }

        /* --- Scratch Button Styling --- */
        #scratchBtn {
            background: #ffffff; /* White Button */
            color: #000000; /* Black Text */
            border: none;
            padding: 20px 60px; /* Made wider */
            font-size: 22px;
            border-radius: 12px;
            cursor: pointer;
            box-shadow: 0 0 20px rgba(255,255,255,0.12), 0 6px 18px rgba(0,0,0,0.6);
            transition: transform 120ms ease, box-shadow 120ms ease;
            outline: none;
            width: 300px; /* Fixed width for wide look */
        }

        #scratchBtn:hover {
            transform: translateY(-3px);
            box-shadow: 0 0 30px rgba(255,255,255,0.22), 0 10px 28px rgba(0,0,0,0.7);
        }

        /* glowing effect when active */
        #scratchBtn.glow {
            box-shadow: 0 0 40px rgba(255,255,255,0.95), 0 10px 40px rgba(255,255,255,0.15);
            transform: scale(1.03);
        }

        .desc {
            margin-top: 12px;
            color: #ddd;
            font-size: 14px;
        }

        /* --- Upgrades Panel Styling --- */
        #upgrades-panel {
            width: 90%;
            max-width: 400px;
            margin-top: 40px;
            padding: 10px;
            border: 1px solid #333;
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.05);
        }

        #upgrades-panel h3 {
            text-align: center;
            margin-top: 0;
            border-bottom: 1px solid #333;
            padding-bottom: 5px;
            margin-bottom: 10px;
        }

        .upgrade-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 15px;
            margin-bottom: 8px;
            background: #222;
            border-radius: 6px;
            cursor: pointer;
            transition: background 0.1s ease;
        }

        .upgrade-item:hover {
            background: #333;
        }

        .upgrade-item:active {
            transform: translateY(1px);
        }

        .asset-name {
            font-weight: 700;
            flex-basis: 35%;
        }

        .asset-count {
            font-weight: 700;
            flex-basis: 15%;
            text-align: right;
            color: #4CAF50;
        }

        .asset-kps {
            flex-basis: 15%;
            text-align: right;
            font-size: 0.8em;
            color: #999;
        }
        
        .asset-cost {
            flex-basis: 35%;
            text-align: right;
            font-weight: 700;
            color: #FFEB3B;
        }
        
        .upgrade-item.locked {
            opacity: 0.4;
            cursor: default;
        }

        /* small responsive adjustments */
        @media (max-width:480px) {
            #kittycoins { font-size: 40px; }
            .kps-display { top: 60px; font-size: 16px; }
            #scratchBtn { padding: 14px 22px; font-size:18px; width: 250px; }
        }
    </style>
</head>
<body>
    <div id="kittycoins">KitCoins: 0</div>
    <div class="kps-display">KPS: <span id="kpsCount">0</span></div>

    <div class="game-area">
        <button id="scratchBtn" title="Scratch to earn KitCoins!">Scratch the Post!</button>
        <p class="desc">Earn <span id="scratchPower">1</span> KitCoin per scratch.</p>
    </div>

    <div id="upgrades-panel">
        <h3>Assets & Upgrades</h3>
        <div class="upgrade-item" id="postUpgradeItem">
            <span class="asset-name">Scratching Post</span>
            <span class="asset-count" id="postCount">0</span>
            <span class="asset-kps">KPS: 1</span>
            <span class="asset-cost" id="postCostDisplay">Cost: 10 KitCoins</span>
        </div>
    </div>

    <script>
        (function(){
            // --- Game Setup and Variables ---
            const STORAGE_KEY = 'kittycoins_game';
            
            // Asset Data
            const assets = {
                post: {
                    count: 0,
                    baseCost: 10,
                    cost: 10, 
                    kps: 1,  
                    power: 1.15 // Cost growth factor
                }
            };

            let kitCoins = 1; // Start with 1 KitCoin
            let clickPower = 1; 
            let kitCoinsPerSecond = 0;
            
            // DOM References
            const display = document.getElementById('kittycoins');
            const kpsDisplay = document.getElementById('kpsCount');
            const postCountDisplay = document.getElementById('postCount');
            const postCostDisplay = document.getElementById('postCostDisplay');
            const scratchPowerDisplay = document.getElementById('scratchPower');
            const scratchBtn = document.getElementById('scratchBtn');
            const postUpgradeItem = document.getElementById('postUpgradeItem');


            // --- Save/Load Functions ---

            function saveGame() {
                const gameState = {
                    c: kitCoins,
                    p: clickPower,
                    a: assets
                };
                localStorage.setItem(STORAGE_KEY, JSON.stringify(gameState));
            }

            function loadGame() {
                const stored = localStorage.getItem(STORAGE_KEY);
                if (stored) {
                    const gameState = JSON.parse(stored);
                    kitCoins = gameState.c || 1;
                    clickPower = gameState.p || 1;
                    
                    if(gameState.a && gameState.a.post) {
                        assets.post.count = gameState.a.post.count || 0;
                        assets.post.cost = gameState.a.post.cost || assets.post.baseCost;
                    }
                }
            }
            
            
            // --- Core Game Functions ---

            function calculateKPS() {
                // Calculate total KPS from all assets
                kitCoinsPerSecond = assets.post.count * assets.post.kps;
            }

            function updateDisplay() {
                // Update currency and statistics, formatted for readability
                display.textContent = 'KitCoins: ' + Math.floor(kitCoins).toLocaleString('en-US');
                kpsDisplay.textContent = kitCoinsPerSecond.toLocaleString('en-US');
                scratchPowerDisplay.textContent = clickPower;
                
                // Update asset displays
                postCountDisplay.textContent = assets.post.count;
                postCostDisplay.textContent = 'Cost: ' + Math.ceil(assets.post.cost).toLocaleString('en-US') + ' KitCoins';

                // Toggle purchase ability look
                if (kitCoins >= assets.post.cost) {
                    postUpgradeItem.classList.remove('locked');
                } else {
                    postUpgradeItem.classList.add('locked');
                }
            }
            
            // *** This is the corrected function for clicking the button ***
            function scratchPost() {
                kitCoins += clickPower; // Adds the clickPower amount
                
                // brief glow animation
                scratchBtn.classList.add('glow');
                setTimeout(() => scratchBtn.classList.remove('glow'), 200);

                saveGame();
                updateDisplay();
            }

            function buyAsset(assetId) {
                const asset = assets[assetId];

                if (kitCoins >= asset.cost) {
                    kitCoins -= asset.cost; 
                    asset.count += 1;
                    asset.cost *= asset.power; 
                    
                    // Since the Scratching Post is the only asset, we can use it to also increase click power, making it a dual upgrade!
                    clickPower += 1; 

                    calculateKPS();
                    saveGame();
                    updateDisplay();
                } else {
                    console.log("Not enough KitCoins to buy " + assetId + "!");
                }
            }
            
            // Make buyAsset accessible from HTML onclick, and attach scratchPost to the button
            window.buyAsset = buyAsset; 
            scratchBtn.addEventListener('click', scratchPost); // Correctly attaches click-to-earn logic
            
            // The purchase event is now handled by clicking the upgrade panel item itself:
            postUpgradeItem.addEventListener('click', () => buyAsset('post'));


            // --- The Idle Loop (Runs every second) ---
            function generateIdleKitCoins() {
                if (kitCoinsPerSecond > 0) {
                    // It's common to use a smaller interval (e.g., 100ms) for smoother generation:
                    // kitCoins += kitCoinsPerSecond / 10; 
                    // But we'll stick to 1 second for simplicity for now:
                    kitCoins += kitCoinsPerSecond; 
                    saveGame();
                    updateDisplay();
                }
            }

            // Start the game loop (1000ms = 1 second)
            setInterval(generateIdleKitCoins, 1000);
            

            // --- Initial Game Load ---
            loadGame();
            calculateKPS();
            updateDisplay();
        })();
    </script>
</body>
</html>
